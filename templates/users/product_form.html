{% extends "base.html" %}
{% block title %}{% if object %}Edit Product{% else %}Add Product{% endif %} · LocalFarmConnect{% endblock %}

{% block content %}
<section class="max-w-4xl mx-auto space-y-8 fade-in">

  <!-- Back -->
  <a href="{% url 'farmer-products' %}"
     class="inline-flex items-center gap-2 text-sm text-slate-500 hover:text-emerald-700 transition">
    ← Back to products
  </a>

  <!-- Card -->
  <div class="bg-white rounded-3xl shadow-lg border border-slate-100 overflow-hidden">

    <!-- Header -->
    <div class="px-8 py-6 border-b border-slate-100 bg-gradient-to-r from-emerald-50 to-white">
      <h1 class="text-2xl font-bold text-slate-900">
        {% if object %}Edit product{% else %}Add new product{% endif %}
      </h1>
      <p class="text-sm text-slate-600 mt-1">
        Provide accurate details to help buyers trust and choose your produce.
      </p>
    </div>

    <!-- Form -->
    <form method="post" enctype="multipart/form-data" class="p-8 space-y-8">
      {% csrf_token %}

      <!-- ================= PRODUCT INFO ================= -->
      <div class="space-y-5">
        <h3 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">
          Product information
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

          <!-- Name -->
          <div class="space-y-1">
            <label class="block text-sm font-medium text-slate-700">
              Product name
            </label>
            {{ form.name }}
          </div>

          <!-- ✅ MODERN CATEGORY FIELD -->
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-slate-800">
              Category
            </label>

            <div class="relative">

              <div class="relative rounded-xl border border-slate-200 bg-white
                          focus-within:ring-2 focus-within:ring-emerald-500
                          focus-within:border-emerald-500 transition">

                {{ form.category }}

                <!-- dropdown icon -->
                <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-slate-400">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2"
                       viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M19 9l-7 7-7-7"/>
                  </svg>
                </div>

              </div>

            </div>

            <p class="text-xs text-slate-500">
              Choose the category that best describes your product.
            </p>

            {% if form.category.errors %}
              <p class="text-xs text-red-600 font-medium">
                {{ form.category.errors.0 }}
              </p>
            {% endif %}
          </div>

        </div>

        <!-- Description -->
        <div class="space-y-1">
          <label class="block text-sm font-medium text-slate-700">
            Description
          </label>
          {{ form.description }}
        </div>
      </div>


      <!-- ================= PRICING ================= -->
      <div class="space-y-5">
        <h3 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">
          Pricing & inventory
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

          <div class="space-y-1">
            <label class="block text-sm font-medium text-slate-700">
              Price (KSh)
            </label>
            {{ form.price }}
          </div>

          <div class="space-y-1">
            <label class="block text-sm font-medium text-slate-700">
              Quantity available
            </label>
            {{ form.quantity_available }}
          </div>

        </div>
      </div>


      <!-- ================= IMAGE ================= -->
      <div class="space-y-3">
        <h3 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">
          Product image
        </h3>

        <div class="border-2 border-dashed border-slate-200 rounded-2xl p-6
                    bg-slate-50 hover:border-emerald-400 transition">
          <p class="text-xs text-slate-500 mb-2">
            Upload a clear photo of your product. Good lighting increases sales.
          </p>
          {{ form.image }}
        </div>
      </div>


      <!-- ================= ACTIONS ================= -->
      <div class="flex flex-col sm:flex-row gap-3 pt-6 border-t border-slate-100">

        <button type="submit"
                class="inline-flex justify-center items-center px-6 py-3 rounded-xl
                       bg-emerald-600 text-white text-sm font-semibold shadow-md
                       hover:bg-emerald-700 hover:shadow-lg transition">
          Save product
        </button>

        <a href="{% url 'farmer-products' %}"
           class="inline-flex justify-center items-center px-6 py-3 rounded-xl
                  bg-slate-100 text-slate-800 text-sm font-semibold
                  hover:bg-slate-200 transition">
          Cancel
        </a>

      </div>

    </form>
  </div>
</section>
{% endblock %}